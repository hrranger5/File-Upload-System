<!doctype html>
<html>
  <body>
    <h3>Upload resume / project</h3>
    <form id="uploadForm">
      <input type="file" name="file" id="fileInput" accept=".pdf,.doc,.docx,.zip,.pptx,.txt,.rar" />
      <button type="submit">Upload</button>
    </form>

    <script>
      document.getElementById('uploadForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        const f = document.getElementById('fileInput').files[0];
        if (!f) return alert('Choose a file');

        // Client-side validation (size & type) â€” matches server rules
        const maxSize = 5 * 1024 * 1024; // 5MB
        if (f.size > maxSize) return alert('File too large (max 5MB)');

        const allowed = ['pdf','doc','docx','zip','pptx','txt','rar'];
        const ext = f.name.split('.').pop().toLowerCase();
        if (!allowed.includes(ext)) return alert('Invalid file type');

        const form = new FormData();
        form.append('file', f);

        // If you use cookies/session auth, this will include them. If JWT, set Authorization header.
        const res = await fetch('/api/files/upload', {
          method: 'POST',
          body: form
        });
        const data = await res.json();
        if (!res.ok) return alert('Upload failed: ' + (data?.error || JSON.stringify(data)));
        alert('Upload success! File URL: ' + data.file.url);
      });
    </script>
  </body>
</html>
